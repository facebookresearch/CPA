nohup: ignoring input
WARNING: Default of the method has been changed to 't-test' from 't-test_overestim_var'
WARNING: Default of the method has been changed to 't-test' from 't-test_overestim_var'
WARNING: Default of the method has been changed to 't-test' from 't-test_overestim_var'
WARNING: Default of the method has been changed to 't-test' from 't-test_overestim_var'
WARNING: Default of the method has been changed to 't-test' from 't-test_overestim_var'
WARNING: Default of the method has been changed to 't-test' from 't-test_overestim_var'
WARNING: Default of the method has been changed to 't-test' from 't-test_overestim_var'
WARNING: Default of the method has been changed to 't-test' from 't-test_overestim_var'
Creating 'cov_drug_dose_name' field.
Ranking genes for DE genes.
{"training_args": {"data": "/home/ubuntu/Documents/CPA/datasets/marson_prepped_no-ood.h5ad", "perturbation_key": "perturbation", "control": null, "dose_key": "dose_val", "covariate_keys": ["celltype", "donor", "stim"], "split_key": "split", "loss_ae": "gauss", "doser_type": "sigm", "decoder_activation": "linear", "seed": 0, "hparams": "", "max_epochs": 1000, "max_minutes": 300, "patience": 20, "checkpoint_freq": 20, "save_dir": "/home/ubuntu/Documents/CPA/artifact", "sweep_seeds": 200}}
{"autoencoder_params": {"dim": 128, "dosers_width": 128, "dosers_depth": 2, "dosers_lr": 0.004, "dosers_wd": 1e-07, "autoencoder_width": 128, "autoencoder_depth": 3, "adversary_width": 64, "adversary_depth": 2, "reg_adversary": 60, "penalty_adversary": 60, "autoencoder_lr": 0.0003, "adversary_lr": 0.0003, "autoencoder_wd": 4e-07, "adversary_wd": 4e-07, "adversary_steps": 3, "batch_size": 256, "step_size_lr": 45}}
{"epoch": 0, "training_stats": {"loss_reconstruction": -0.13838895142731827, "loss_adv_drugs": 0.7053869717544125, "loss_adv_covariates": 2.083183402015317, "penalty_adv_drugs": 0.02660579515260554, "penalty_adv_covariates": 0.006774867535568774}, "evaluation_stats": {"training": [0.31283687829681267, 0.03431603046479035, -5.674479392422938, -4.8972672481687685], "test": [0.3771123593673962, -0.05519755648986712, -5.359670317680635, -2.444797433290928], "ood": [-1, -1, -1, -1], "perturbation disentanglement": 0.01388187799602747, "optimal for perturbations": 0.014285714285714285, "celltype disentanglement": 0.4967188537120819, "optimal for celltype": 0.5, "donor disentanglement": 0.529151976108551, "optimal for donor": 0.5, "stim disentanglement": 0.5388692617416382, "optimal for stim": 0.5}, "ellapsed_minutes": 0.07043980360031128}
{"model_saved": "model_seed=0_epoch=0.pt\n"}
{"epoch": 20, "training_stats": {"loss_reconstruction": -1.3347090482711792, "loss_adv_drugs": 0.48980657588089666, "loss_adv_covariates": 1.7708783591947248, "penalty_adv_drugs": 6.283300491861976e-06, "penalty_adv_covariates": 2.573371495835149e-05}, "evaluation_stats": {"training": [0.8989519015142386, 0.5476308523324372, 0.8405286778821371, 0.41191831939313744], "test": [0.8871772874401826, 0.5826602634003569, 0.8073054806625063, 0.5126865504166016], "ood": [-1, -1, -1, -1], "perturbation disentanglement": 0.03243311494588852, "optimal for perturbations": 0.014285714285714285, "celltype disentanglement": 0.6082786917686462, "optimal for celltype": 0.5, "donor disentanglement": 0.5070671439170837, "optimal for donor": 0.5, "stim disentanglement": 0.35827866196632385, "optimal for stim": 0.5}, "ellapsed_minutes": 5.434725705782572}
{"model_saved": "model_seed=0_epoch=20.pt\n"}
{"epoch": 40, "training_stats": {"loss_reconstruction": -1.3600138618100075, "loss_adv_drugs": 0.1365518166172889, "loss_adv_covariates": 1.9629097023317892, "penalty_adv_drugs": 4.039765817945027e-05, "penalty_adv_covariates": 6.823093210715019e-06}, "evaluation_stats": {"training": [0.9065795667781843, 0.5517167570204144, 0.794386142071028, 0.40032747764433635], "test": [0.8909345707191464, 0.5758653545993253, 0.718450564205526, 0.3680997582012784], "ood": [-1, -1, -1, -1], "perturbation disentanglement": 0.015143867582082748, "optimal for perturbations": 0.014285714285714285, "celltype disentanglement": 0.4882635176181793, "optimal for celltype": 0.5, "donor disentanglement": 0.4994952380657196, "optimal for donor": 0.5, "stim disentanglement": 0.6583796143531799, "optimal for stim": 0.5}, "ellapsed_minutes": 11.431492173671723}
{"model_saved": "model_seed=0_epoch=40.pt\n"}
{"epoch": 60, "training_stats": {"loss_reconstruction": -1.3696959220593976, "loss_adv_drugs": 0.07497062179590425, "loss_adv_covariates": 2.0430721544450328, "penalty_adv_drugs": 1.212955871485446e-06, "penalty_adv_covariates": 1.0100509948716212e-06}, "evaluation_stats": {"training": [0.9089595307358991, 0.5889700653629505, 0.8050875237278731, 0.4214826324486778], "test": [0.9114920548217554, 0.7211207893058932, 0.759830768175151, 0.44664336053569514], "ood": [-1, -1, -1, -1], "perturbation disentanglement": 0.02057041972875595, "optimal for perturbations": 0.014285714285714285, "celltype disentanglement": 0.568526029586792, "optimal for celltype": 0.5, "donor disentanglement": 0.4935638904571533, "optimal for donor": 0.5, "stim disentanglement": 0.5005047917366028, "optimal for stim": 0.5}, "ellapsed_minutes": 21.500372687975567}
{"model_saved": "model_seed=0_epoch=60.pt\n"}
