nohup: ignoring input
WARNING: Default of the method has been changed to 't-test' from 't-test_overestim_var'
WARNING: Default of the method has been changed to 't-test' from 't-test_overestim_var'
WARNING: Default of the method has been changed to 't-test' from 't-test_overestim_var'
WARNING: Default of the method has been changed to 't-test' from 't-test_overestim_var'
WARNING: Default of the method has been changed to 't-test' from 't-test_overestim_var'
WARNING: Default of the method has been changed to 't-test' from 't-test_overestim_var'
WARNING: Default of the method has been changed to 't-test' from 't-test_overestim_var'
WARNING: Default of the method has been changed to 't-test' from 't-test_overestim_var'
Creating 'cov_drug_dose_name' field.
Ranking genes for DE genes.
{"training_args": {"data": "/home/ubuntu/Documents/CPA/datasets/marson_prepped_no-ood.h5ad", "perturbation_key": "perturbation", "control": null, "dose_key": "dose_val", "covariate_keys": ["celltype", "donor", "stim"], "split_key": "split", "loss_ae": "gauss", "doser_type": "sigm", "decoder_activation": "linear", "seed": 0, "hparams": "", "max_epochs": 1000, "max_minutes": 300, "patience": 20, "checkpoint_freq": 20, "save_dir": "/home/ubuntu/Documents/CPA/artifact", "sweep_seeds": 200}}
{"autoencoder_params": {"dim": 128, "dosers_width": 128, "dosers_depth": 2, "dosers_lr": 0.004, "dosers_wd": 1e-07, "autoencoder_width": 128, "autoencoder_depth": 3, "adversary_width": 64, "adversary_depth": 2, "reg_adversary": 60, "penalty_adversary": 60, "autoencoder_lr": 0.0003, "adversary_lr": 0.0003, "autoencoder_wd": 4e-07, "adversary_wd": 4e-07, "adversary_steps": 3, "batch_size": 256, "step_size_lr": 45}}
{"epoch": 0, "training_stats": {"loss_reconstruction": -0.14513537651697744, "loss_adv_drugs": 0.7031441590478343, "loss_adv_covariates": 2.044277515142195, "penalty_adv_drugs": 0.033328429012814714, "penalty_adv_covariates": 0.007225284461803254}, "evaluation_stats": {"training": [0.3777153229850822, 0.09894551858631453, -5.394165639046548, -4.623472485408622], "test": [0.40730201873952215, -0.009128143877988179, -5.563669479940796, -2.263503422574058], "ood": [-1, -1, -1, -1], "perturbation disentanglement": 0.01842503808438778, "optimal for perturbations": 0.014285714285714285, "celltype disentanglement": 0.5296567678451538, "optimal for celltype": 0.5, "donor disentanglement": 0.4885159134864807, "optimal for donor": 0.5, "stim disentanglement": 0.4043412506580353, "optimal for stim": 0.5}, "ellapsed_minutes": 0.05390450159708659}
{"model_saved": "model_seed=0_epoch=0.pt\n"}
{"epoch": 20, "training_stats": {"loss_reconstruction": -1.3277387224858808, "loss_adv_drugs": 0.49014099759440266, "loss_adv_covariates": 1.7321575783914136, "penalty_adv_drugs": 1.1026792259555453e-05, "penalty_adv_covariates": 2.4284996001252665e-05}, "evaluation_stats": {"training": [0.9039450908779204, 0.5468811750288903, 0.8460454625140319, 0.4090231980526174], "test": [0.8890609701018013, 0.5779233126764255, 0.8104292953714699, 0.4496194538792304], "ood": [-1, -1, -1, -1], "perturbation disentanglement": 0.009717314504086971, "optimal for perturbations": 0.014285714285714285, "celltype disentanglement": 0.5349571108818054, "optimal for celltype": 0.5, "donor disentanglement": 0.46516913175582886, "optimal for donor": 0.5, "stim disentanglement": 0.6915699243545532, "optimal for stim": 0.5}, "ellapsed_minutes": 1.501993183294932}
{"model_saved": "model_seed=0_epoch=20.pt\n"}
{"epoch": 40, "training_stats": {"loss_reconstruction": -1.3441220060471566, "loss_adv_drugs": 0.1787146281811499, "loss_adv_covariates": 2.003913724614728, "penalty_adv_drugs": 1.8774255529992402e-05, "penalty_adv_covariates": 1.854358456952351e-06}, "evaluation_stats": {"training": [0.9070061510583131, 0.5618436135965682, 0.8428132238233842, 0.42741958096409616], "test": [0.9016411729180621, 0.6472786015934228, 0.7961150627073362, 0.42005391067497233], "ood": [-1, -1, -1, -1], "perturbation disentanglement": 0.03975265100598335, "optimal for perturbations": 0.014285714285714285, "celltype disentanglement": 0.4004290997982025, "optimal for celltype": 0.5, "donor disentanglement": 0.4782938063144684, "optimal for donor": 0.5, "stim disentanglement": 0.43589097261428833, "optimal for stim": 0.5}, "ellapsed_minutes": 3.1463377674420676}
{"model_saved": "model_seed=0_epoch=40.pt\n"}
{"epoch": 60, "training_stats": {"loss_reconstruction": -1.3638597419185023, "loss_adv_drugs": 0.07792511810698817, "loss_adv_covariates": 1.9733060088849836, "penalty_adv_drugs": 4.475635983402343e-07, "penalty_adv_covariates": 1.8582036767794864e-06}, "evaluation_stats": {"training": [0.9120282185659425, 0.5724622879096939, 0.8093183867857083, 0.43964211771677625], "test": [0.9052404600827298, 0.6960991762316316, 0.7576420703666747, 0.4087709085291484], "ood": [-1, -1, -1, -1], "perturbation disentanglement": 0.01678445376455784, "optimal for perturbations": 0.014285714285714285, "celltype disentanglement": 0.4562090039253235, "optimal for celltype": 0.5, "donor disentanglement": 0.532559335231781, "optimal for donor": 0.5, "stim disentanglement": 0.35310450196266174, "optimal for stim": 0.5}, "ellapsed_minutes": 4.759693992137909}
{"model_saved": "model_seed=0_epoch=60.pt\n"}
{"epoch": 80, "training_stats": {"loss_reconstruction": -1.3791790133522404, "loss_adv_drugs": 0.07237191227895598, "loss_adv_covariates": 2.052247643470764, "penalty_adv_drugs": 7.397417562017606e-10, "penalty_adv_covariates": 4.701609334974379e-07}, "evaluation_stats": {"training": [0.9078968907248415, 0.5595663276711751, 0.7814712311936157, 0.4066164345378694], "test": [0.8914376947938883, 0.5980707778864709, 0.7061999241125575, 0.29432705829229366], "ood": [-1, -1, -1, -1], "perturbation disentanglement": 0.012367491610348225, "optimal for perturbations": 0.014285714285714285, "celltype disentanglement": 0.49785465002059937, "optimal for celltype": 0.5, "donor disentanglement": 0.5184250473976135, "optimal for donor": 0.5, "stim disentanglement": 0.4968450367450714, "optimal for stim": 0.5}, "ellapsed_minutes": 6.298774643739065}
{"model_saved": "model_seed=0_epoch=80.pt\n"}
{"epoch": 100, "training_stats": {"loss_reconstruction": -1.3859743043299644, "loss_adv_drugs": 0.07220401759109189, "loss_adv_covariates": 2.061308524300975, "penalty_adv_drugs": 3.939903869454152e-12, "penalty_adv_covariates": 3.2869479743031926e-07}, "evaluation_stats": {"training": [0.908206691325752, 0.5622673773193907, 0.7712626220712879, 0.40056550389351314], "test": [0.8804730350262456, 0.5347940987605854, 0.6875939606424734, 0.27156336947113724], "ood": [-1, -1, -1, -1], "perturbation disentanglement": 0.012872287072241306, "optimal for perturbations": 0.014285714285714285, "celltype disentanglement": 0.5343261361122131, "optimal for celltype": 0.5, "donor disentanglement": 0.5012620091438293, "optimal for donor": 0.5, "stim disentanglement": 0.49899041652679443, "optimal for stim": 0.5}, "ellapsed_minutes": 7.982039988040924}
{"model_saved": "model_seed=0_epoch=100.pt\n"}
{"epoch": 120, "training_stats": {"loss_reconstruction": -1.393866575533344, "loss_adv_drugs": 0.07196340018943433, "loss_adv_covariates": 2.0545520897834533, "penalty_adv_drugs": 4.3786733325189955e-07, "penalty_adv_covariates": 2.409033385678442e-07}, "evaluation_stats": {"training": [0.9101340230056467, 0.5772146339260616, 0.7844972949475962, 0.433719635708571], "test": [0.8941831396399591, 0.6201563785617277, 0.7273251034297438, 0.3466386043151109], "ood": [-1, -1, -1, -1], "perturbation disentanglement": 0.01590106077492237, "optimal for perturbations": 0.014285714285714285, "celltype disentanglement": 0.42099952697753906, "optimal for celltype": 0.5, "donor disentanglement": 0.5128722786903381, "optimal for donor": 0.5, "stim disentanglement": 0.4949520528316498, "optimal for stim": 0.5}, "ellapsed_minutes": 9.463306605815887}
{"model_saved": "model_seed=0_epoch=120.pt\n"}
{"epoch": 140, "training_stats": {"loss_reconstruction": -1.3912300659764198, "loss_adv_drugs": 0.07202591404559151, "loss_adv_covariates": 2.065358396499388, "penalty_adv_drugs": 3.2790181175280484e-10, "penalty_adv_covariates": 2.5325007455986424e-07}, "evaluation_stats": {"training": [0.9097528112946822, 0.5725447968568487, 0.7895414299697429, 0.4360552820697382], "test": [0.8868085634939593, 0.571513668959068, 0.7366915930599284, 0.42402677250429627], "ood": [-1, -1, -1, -1], "perturbation disentanglement": 0.012241292744874954, "optimal for perturbations": 0.014285714285714285, "celltype disentanglement": 0.5503534078598022, "optimal for celltype": 0.5, "donor disentanglement": 0.5109792947769165, "optimal for donor": 0.5, "stim disentanglement": 0.4506562650203705, "optimal for stim": 0.5}, "ellapsed_minutes": 10.984360265731812}
{"model_saved": "model_seed=0_epoch=140.pt\n"}
{"epoch": 160, "training_stats": {"loss_reconstruction": -1.4015935870908922, "loss_adv_drugs": 0.07195008600190762, "loss_adv_covariates": 2.056369285429678, "penalty_adv_drugs": 5.102380720764947e-12, "penalty_adv_covariates": 1.7923816421036843e-07}, "evaluation_stats": {"training": [0.9145824781187651, 0.5819423394554416, 0.775239658257713, 0.43124838940239973], "test": [0.9028932130912272, 0.6589271181864415, 0.7292545043921708, 0.44001196451217034], "ood": [-1, -1, -1, -1], "perturbation disentanglement": 0.013503281399607658, "optimal for perturbations": 0.014285714285714285, "celltype disentanglement": 0.573069155216217, "optimal for celltype": 0.5, "donor disentanglement": 0.49886423349380493, "optimal for donor": 0.5, "stim disentanglement": 0.4535588324069977, "optimal for stim": 0.5}, "ellapsed_minutes": 12.629274745782217}
{"model_saved": "model_seed=0_epoch=160.pt\n"}
{"epoch": 180, "training_stats": {"loss_reconstruction": -1.4039706520495876, "loss_adv_drugs": 0.07198383388740401, "loss_adv_covariates": 2.0548015794446393, "penalty_adv_drugs": 1.5963487619739275e-11, "penalty_adv_covariates": 9.605008481762231e-08}, "evaluation_stats": {"training": [0.9146034800030626, 0.5828887305412784, 0.7737813108813497, 0.4365909779656745], "test": [0.8952128425809115, 0.6132375842660172, 0.7190578017504405, 0.4307752669807003], "ood": [-1, -1, -1, -1], "perturbation disentanglement": 0.011484099552035332, "optimal for perturbations": 0.014285714285714285, "celltype disentanglement": 0.6066380739212036, "optimal for celltype": 0.5, "donor disentanglement": 0.49823322892189026, "optimal for donor": 0.5, "stim disentanglement": 0.49331146478652954, "optimal for stim": 0.5}, "ellapsed_minutes": 14.32401872475942}
{"model_saved": "model_seed=0_epoch=180.pt\n"}
{"epoch": 200, "training_stats": {"loss_reconstruction": -1.4074712164940373, "loss_adv_drugs": 0.07190559485987309, "loss_adv_covariates": 2.0579795125992066, "penalty_adv_drugs": 1.9789662023790074e-08, "penalty_adv_covariates": 2.9203056855874e-07}, "evaluation_stats": {"training": [0.9152038707512204, 0.588407177389281, 0.7735639839566599, 0.4466927603786569], "test": [0.8978206788247457, 0.628295268164051, 0.7178641203278101, 0.4293371830961524], "ood": [-1, -1, -1, -1], "perturbation disentanglement": 0.01754164695739746, "optimal for perturbations": 0.014285714285714285, "celltype disentanglement": 0.40257447957992554, "optimal for celltype": 0.5, "donor disentanglement": 0.47905099391937256, "optimal for donor": 0.5, "stim disentanglement": 0.49558305740356445, "optimal for stim": 0.5}, "ellapsed_minutes": 16.039636381467183}
{"model_saved": "model_seed=0_epoch=200.pt\n"}
{"epoch": 220, "training_stats": {"loss_reconstruction": -1.4116384675425868, "loss_adv_drugs": 0.07206180409318017, "loss_adv_covariates": 2.0580456045366105, "penalty_adv_drugs": 3.742014175351544e-11, "penalty_adv_covariates": 1.2415390751316996e-07}, "evaluation_stats": {"training": [0.9168151787370108, 0.5945233197403905, 0.7784463148300683, 0.4609915819977012], "test": [0.905895456184811, 0.6797547202383333, 0.7282347934191815, 0.4567699104253999], "ood": [-1, -1, -1, -1], "perturbation disentanglement": 0.018046442419290543, "optimal for perturbations": 0.014285714285714285, "celltype disentanglement": 0.48674914240837097, "optimal for celltype": 0.5, "donor disentanglement": 0.4775366187095642, "optimal for donor": 0.5, "stim disentanglement": 0.5116103291511536, "optimal for stim": 0.5}, "ellapsed_minutes": 17.390242489178977}
{"model_saved": "model_seed=0_epoch=220.pt\n"}
{"epoch": 240, "training_stats": {"loss_reconstruction": -1.410644196694897, "loss_adv_drugs": 0.07220463604936676, "loss_adv_covariates": 2.0601647150131965, "penalty_adv_drugs": 1.0762702853715375e-09, "penalty_adv_covariates": 9.024658949890122e-08}, "evaluation_stats": {"training": [0.9148982703331764, 0.59274267411802, 0.7769499998847095, 0.44902178693204053], "test": [0.8997571336338228, 0.6456012471902018, 0.721428687583855, 0.4481997804088229], "ood": [-1, -1, -1, -1], "perturbation disentanglement": 0.01817264035344124, "optimal for perturbations": 0.014285714285714285, "celltype disentanglement": 0.549974799156189, "optimal for celltype": 0.5, "donor disentanglement": 0.47968199849128723, "optimal for donor": 0.5, "stim disentanglement": 0.5410146713256836, "optimal for stim": 0.5}, "ellapsed_minutes": 18.94402918815613}
{"model_saved": "model_seed=0_epoch=240.pt\n"}
{"epoch": 260, "training_stats": {"loss_reconstruction": -1.4165592905013793, "loss_adv_drugs": 0.07231914912981371, "loss_adv_covariates": 2.0579910739775626, "penalty_adv_drugs": 1.1632885887597818e-06, "penalty_adv_covariates": 4.598806216125145e-08}, "evaluation_stats": {"training": [0.917309320219802, 0.6034237248114014, 0.7742863010134295, 0.4666522929853919], "test": [0.9019397293796025, 0.6699295604360103, 0.7138491793907571, 0.4460500152337085], "ood": [-1, -1, -1, -1], "perturbation disentanglement": 0.01388187799602747, "optimal for perturbations": 0.014285714285714285, "celltype disentanglement": 0.4280666410923004, "optimal for celltype": 0.5, "donor disentanglement": 0.4936900734901428, "optimal for donor": 0.5, "stim disentanglement": 0.4477536678314209, "optimal for stim": 0.5}, "ellapsed_minutes": 20.5661115248998}
{"model_saved": "model_seed=0_epoch=260.pt\n"}
{"epoch": 280, "training_stats": {"loss_reconstruction": -1.4152933147645765, "loss_adv_drugs": 0.07251118123531342, "loss_adv_covariates": 2.058259335256392, "penalty_adv_drugs": 9.232942906459599e-08, "penalty_adv_covariates": 2.2269486799422845e-08}, "evaluation_stats": {"training": [0.9196006577838527, 0.6095898050707909, 0.7849934392983439, 0.478727231797541], "test": [0.9133927502931126, 0.7313437277280649, 0.7356686380928701, 0.48703213994970235], "ood": [-1, -1, -1, -1], "perturbation disentanglement": 0.018803635612130165, "optimal for perturbations": 0.014285714285714285, "celltype disentanglement": 0.5412670373916626, "optimal for celltype": 0.5, "donor disentanglement": 0.5165320634841919, "optimal for donor": 0.5, "stim disentanglement": 0.5093387365341187, "optimal for stim": 0.5}, "ellapsed_minutes": 22.061379194259644}
{"model_saved": "model_seed=0_epoch=280.pt\n"}
{"epoch": 300, "training_stats": {"loss_reconstruction": -1.4189831691403543, "loss_adv_drugs": 0.07262523610505366, "loss_adv_covariates": 2.057155716803766, "penalty_adv_drugs": 2.3233474204891942e-08, "penalty_adv_covariates": 4.2936379956824656e-08}, "evaluation_stats": {"training": [0.91690076504258, 0.6332540987046844, 0.780776201304059, 0.49656270184506707], "test": [0.9228544247288091, 0.7973442234452798, 0.7579729524704218, 0.515972629491185], "ood": [-1, -1, -1, -1], "perturbation disentanglement": 0.01097930409014225, "optimal for perturbations": 0.014285714285714285, "celltype disentanglement": 0.4117870032787323, "optimal for celltype": 0.5, "donor disentanglement": 0.4827107787132263, "optimal for donor": 0.5, "stim disentanglement": 0.5119889378547668, "optimal for stim": 0.5}, "ellapsed_minutes": 23.5400270819664}
{"model_saved": "model_seed=0_epoch=300.pt\n"}
{"epoch": 320, "training_stats": {"loss_reconstruction": -1.4095153597093397, "loss_adv_drugs": 0.07258980913508323, "loss_adv_covariates": 2.054845946450387, "penalty_adv_drugs": 2.954211776282347e-08, "penalty_adv_covariates": 7.493317926011675e-08}, "evaluation_stats": {"training": [0.9217704610620421, 0.6253238608563, 0.8117864094959661, 0.5183962296900528], "test": [0.9198179406214745, 0.7654784916035462, 0.7854394751396133, 0.5909135901766798], "ood": [-1, -1, -1, -1], "perturbation disentanglement": 0.015143867582082748, "optimal for perturbations": 0.014285714285714285, "celltype disentanglement": 0.5810196995735168, "optimal for celltype": 0.5, "donor disentanglement": 0.48485615849494934, "optimal for donor": 0.5, "stim disentanglement": 0.44422009587287903, "optimal for stim": 0.5}, "ellapsed_minutes": 25.156555366516113}
{"model_saved": "model_seed=0_epoch=320.pt\n"}
{"epoch": 340, "training_stats": {"loss_reconstruction": -1.4237175372339064, "loss_adv_drugs": 0.07250966504216194, "loss_adv_covariates": 2.055852565073198, "penalty_adv_drugs": 5.0939145990908277e-08, "penalty_adv_covariates": 1.608078755459756e-08}, "evaluation_stats": {"training": [0.9247042134269483, 0.635486377102099, 0.7857370220346351, 0.506267806654902], "test": [0.9258797281549768, 0.7916344425743187, 0.752480741433046, 0.49548651067071914], "ood": [-1, -1, -1, -1], "perturbation disentanglement": 0.01085310522466898, "optimal for perturbations": 0.014285714285714285, "celltype disentanglement": 0.4030792713165283, "optimal for celltype": 0.5, "donor disentanglement": 0.5126199126243591, "optimal for donor": 0.5, "stim disentanglement": 0.4938162863254547, "optimal for stim": 0.5}, "ellapsed_minutes": 26.679263190428415}
{"model_saved": "model_seed=0_epoch=340.pt\n"}
{"epoch": 360, "training_stats": {"loss_reconstruction": -1.429388400047056, "loss_adv_drugs": 0.0725122653548756, "loss_adv_covariates": 2.0586584787214957, "penalty_adv_drugs": 5.192389844253395e-09, "penalty_adv_covariates": 1.507465470014737e-08}, "evaluation_stats": {"training": [0.9242330456812837, 0.6393547785026163, 0.7761744883833976, 0.5096301797580379], "test": [0.9233253622408956, 0.7845511295278976, 0.7387545323400179, 0.46743138650095784], "ood": [-1, -1, -1, -1], "perturbation disentanglement": 0.017667844891548157, "optimal for perturbations": 0.014285714285714285, "celltype disentanglement": 0.5665068626403809, "optimal for celltype": 0.5, "donor disentanglement": 0.5027763843536377, "optimal for donor": 0.5, "stim disentanglement": 0.4991166293621063, "optimal for stim": 0.5}, "ellapsed_minutes": 28.294151413440705}
{"model_saved": "model_seed=0_epoch=360.pt\n"}
{"epoch": 380, "training_stats": {"loss_reconstruction": -1.432564143211611, "loss_adv_drugs": 0.07260128873730859, "loss_adv_covariates": 2.056479254076558, "penalty_adv_drugs": 1.735421368034571e-07, "penalty_adv_covariates": 8.954002020120716e-09}, "evaluation_stats": {"training": [0.9187268213764656, 0.6329158119480928, 0.7613147061725244, 0.48231649879050514], "test": [0.9174786795532338, 0.7638452114877085, 0.7198017138839848, 0.44585791719879847], "ood": [-1, -1, -1, -1], "perturbation disentanglement": 0.015270066447556019, "optimal for perturbations": 0.014285714285714285, "celltype disentanglement": 0.6020949482917786, "optimal for celltype": 0.5, "donor disentanglement": 0.4830893576145172, "optimal for donor": 0.5, "stim disentanglement": 0.4907875061035156, "optimal for stim": 0.5}, "ellapsed_minutes": 30.026433499654136}
{"model_saved": "model_seed=0_epoch=380.pt\n"}
{"epoch": 400, "training_stats": {"loss_reconstruction": -1.432584233822361, "loss_adv_drugs": 0.07265401150911086, "loss_adv_covariates": 2.059528079725081, "penalty_adv_drugs": 2.2237757202510366e-07, "penalty_adv_covariates": 2.5728584657035103e-09}, "evaluation_stats": {"training": [0.9252708157038145, 0.6397212338167657, 0.7810967992779455, 0.516789100560779], "test": [0.9219302947803812, 0.7646311090407614, 0.7393628078962496, 0.49482866996249614], "ood": [-1, -1, -1, -1], "perturbation disentanglement": 0.014260475523769855, "optimal for perturbations": 0.014285714285714285, "celltype disentanglement": 0.42983344197273254, "optimal for celltype": 0.5, "donor disentanglement": 0.4858657419681549, "optimal for donor": 0.5, "stim disentanglement": 0.4207471013069153, "optimal for stim": 0.5}, "ellapsed_minutes": 31.61629236539205}
{"model_saved": "model_seed=0_epoch=400.pt\n"}
{"epoch": 420, "training_stats": {"loss_reconstruction": -1.438372524515275, "loss_adv_drugs": 0.07259236534516658, "loss_adv_covariates": 2.058171562610134, "penalty_adv_drugs": 9.355198628985441e-08, "penalty_adv_covariates": 2.423973110046449e-09}, "evaluation_stats": {"training": [0.9252768289901853, 0.6469536968438413, 0.7758395469568192, 0.5210833805744165], "test": [0.9260544272762461, 0.7984489990391639, 0.7397300324709567, 0.5050819150256024], "ood": [-1, -1, -1, -1], "perturbation disentanglement": 0.012746088206768036, "optimal for perturbations": 0.014285714285714285, "celltype disentanglement": 0.582786500453949, "optimal for celltype": 0.5, "donor disentanglement": 0.5265017747879028, "optimal for donor": 0.5, "stim disentanglement": 0.5302877426147461, "optimal for stim": 0.5}, "ellapsed_minutes": 33.123225287596384}
{"model_saved": "model_seed=0_epoch=420.pt\n"}
{"epoch": 440, "training_stats": {"loss_reconstruction": -1.4399986440135586, "loss_adv_drugs": 0.07268567425349066, "loss_adv_covariates": 2.0572070037164996, "penalty_adv_drugs": 7.343198381617741e-08, "penalty_adv_covariates": 2.083003977189939e-09}, "evaluation_stats": {"training": [0.9255461971268493, 0.6445217819025083, 0.7713651910082673, 0.5073250730517861], "test": [0.9276290921593592, 0.7915643609595736, 0.7389628571762521, 0.5101434474826109], "ood": [-1, -1, -1, -1], "perturbation disentanglement": 0.01110550295561552, "optimal for perturbations": 0.014285714285714285, "celltype disentanglement": 0.478041410446167, "optimal for celltype": 0.5, "donor disentanglement": 0.5237253904342651, "optimal for donor": 0.5, "stim disentanglement": 0.5055527687072754, "optimal for stim": 0.5}, "ellapsed_minutes": 34.66418838103612}
{"model_saved": "model_seed=0_epoch=440.pt\n"}
{"epoch": 460, "training_stats": {"loss_reconstruction": -1.4398685203444572, "loss_adv_drugs": 0.07267019278820484, "loss_adv_covariates": 2.0582387601175616, "penalty_adv_drugs": 5.781334749284249e-08, "penalty_adv_covariates": 1.3126892888094508e-09}, "evaluation_stats": {"training": [0.9208768199611526, 0.6251373590600178, 0.7598930897285571, 0.4861039107690134], "test": [0.9118929377833811, 0.7054533391411694, 0.7110251654470079, 0.4517948789759671], "ood": [-1, -1, -1, -1], "perturbation disentanglement": 0.01539626531302929, "optimal for perturbations": 0.014285714285714285, "celltype disentanglement": 0.39121657609939575, "optimal for celltype": 0.5, "donor disentanglement": 0.4784200191497803, "optimal for donor": 0.5, "stim disentanglement": 0.4636547267436981, "optimal for stim": 0.5}, "ellapsed_minutes": 36.21132936080297}
{"model_saved": "model_seed=0_epoch=460.pt\n"}
{"epoch": 480, "training_stats": {"loss_reconstruction": -1.4455593016839796, "loss_adv_drugs": 0.07270475200587703, "loss_adv_covariates": 2.0575533951482465, "penalty_adv_drugs": 1.5716889106820275e-09, "penalty_adv_covariates": 1.2586727932319175e-09}, "evaluation_stats": {"training": [0.925116852488737, 0.6342836040778035, 0.76358909750332, 0.5062349630879928], "test": [0.9243024897942246, 0.7725881801632211, 0.7199621178181541, 0.440861893117017], "ood": [-1, -1, -1, -1], "perturbation disentanglement": 0.01097930409014225, "optimal for perturbations": 0.014285714285714285, "celltype disentanglement": 0.5743311643600464, "optimal for celltype": 0.5, "donor disentanglement": 0.5224634408950806, "optimal for donor": 0.5, "stim disentanglement": 0.49810704588890076, "optimal for stim": 0.5}, "ellapsed_minutes": 37.84601271947225}
{"model_saved": "model_seed=0_epoch=480.pt\n"}
{"epoch": 500, "training_stats": {"loss_reconstruction": -1.4474965641575475, "loss_adv_drugs": 0.07273879815493861, "loss_adv_covariates": 2.056879610784592, "penalty_adv_drugs": 7.535307577910544e-08, "penalty_adv_covariates": 9.38188161567479e-10}, "evaluation_stats": {"training": [0.9270920403417797, 0.638114686844024, 0.7637825198673363, 0.5071418645065139], "test": [0.9210492272728118, 0.7409072924510879, 0.7148917173883135, 0.4499197144150519], "ood": [-1, -1, -1, -1], "perturbation disentanglement": 0.017163049429655075, "optimal for perturbations": 0.014285714285714285, "celltype disentanglement": 0.5001262426376343, "optimal for celltype": 0.5, "donor disentanglement": 0.4774104058742523, "optimal for donor": 0.5, "stim disentanglement": 0.5223371982574463, "optimal for stim": 0.5}, "ellapsed_minutes": 39.584922182559964}
{"model_saved": "model_seed=0_epoch=500.pt\n"}
{"epoch": 520, "training_stats": {"loss_reconstruction": -1.4455598371644174, "loss_adv_drugs": 0.07279654892702256, "loss_adv_covariates": 2.058723836175857, "penalty_adv_drugs": 3.71076631703801e-11, "penalty_adv_covariates": 6.370966165020018e-10}, "evaluation_stats": {"training": [0.9243476619102494, 0.6385264137778622, 0.774976644019201, 0.5138470936902341], "test": [0.9162554287694865, 0.7351137025661236, 0.7273276310101636, 0.49341878755614393], "ood": [-1, -1, -1, -1], "perturbation disentanglement": 0.021580010652542114, "optimal for perturbations": 0.014285714285714285, "celltype disentanglement": 0.445229709148407, "optimal for celltype": 0.5, "donor disentanglement": 0.47917720675468445, "optimal for donor": 0.5, "stim disentanglement": 0.47879859805107117, "optimal for stim": 0.5}, "ellapsed_minutes": 41.25429386695226}
{"model_saved": "model_seed=0_epoch=520.pt\n"}
{"epoch": 540, "training_stats": {"loss_reconstruction": -1.4519134731061998, "loss_adv_drugs": 0.07276879731685884, "loss_adv_covariates": 2.0578997635072276, "penalty_adv_drugs": 3.971034084785636e-07, "penalty_adv_covariates": 3.369127268837424e-10}, "evaluation_stats": {"training": [0.9227054468419379, 0.6379994295006086, 0.7708603309117295, 0.5206710063499479], "test": [0.91661852318695, 0.7604638180750282, 0.725866407525364, 0.45990470018917645], "ood": [-1, -1, -1, -1], "perturbation disentanglement": 0.0137556791305542, "optimal for perturbations": 0.014285714285714285, "celltype disentanglement": 0.428823858499527, "optimal for celltype": 0.5, "donor disentanglement": 0.4853609502315521, "optimal for donor": 0.5, "stim disentanglement": 0.5107269287109375, "optimal for stim": 0.5}, "ellapsed_minutes": 42.89204800923665}
{"model_saved": "model_seed=0_epoch=540.pt\n"}
{"epoch": 560, "training_stats": {"loss_reconstruction": -1.4459844654606235, "loss_adv_drugs": 0.07276974624443439, "loss_adv_covariates": 2.0582249952900793, "penalty_adv_drugs": 5.995360837615402e-08, "penalty_adv_covariates": 4.160206652736506e-10}, "evaluation_stats": {"training": [0.89954951752255, 0.6297537820617808, 0.7658693718969489, 0.5178223847771787], "test": [0.8943025225791731, 0.7410123097533751, 0.7275937461217273, 0.5101060084472748], "ood": [-1, -1, -1, -1], "perturbation disentanglement": 0.009969712235033512, "optimal for perturbations": 0.014285714285714285, "celltype disentanglement": 0.41342759132385254, "optimal for celltype": 0.5, "donor disentanglement": 0.47677943110466003, "optimal for donor": 0.5, "stim disentanglement": 0.49810704588890076, "optimal for stim": 0.5}, "ellapsed_minutes": 44.64386254151662}
{"model_saved": "model_seed=0_epoch=560.pt\n"}
{"epoch": 580, "training_stats": {"loss_reconstruction": -1.4489955209916638, "loss_adv_drugs": 0.07272404125861583, "loss_adv_covariates": 2.0584525812056755, "penalty_adv_drugs": 7.481260113534696e-10, "penalty_adv_covariates": 1.2852057706599827e-09}, "evaluation_stats": {"training": [0.9268328943307905, 0.6432737239591384, 0.7651955087612099, 0.5127606596130247], "test": [0.9268156849816349, 0.7891030718272547, 0.7266928426873273, 0.48068227287531234], "ood": [-1, -1, -1, -1], "perturbation disentanglement": 0.009843513369560242, "optimal for perturbations": 0.014285714285714285, "celltype disentanglement": 0.4072438180446625, "optimal for celltype": 0.5, "donor disentanglement": 0.5234730243682861, "optimal for donor": 0.5, "stim disentanglement": 0.4943210780620575, "optimal for stim": 0.5}, "ellapsed_minutes": 46.387136427561444}
{"model_saved": "model_seed=0_epoch=580.pt\n"}
{"epoch": 600, "training_stats": {"loss_reconstruction": -1.4551555235539713, "loss_adv_drugs": 0.07275141312951042, "loss_adv_covariates": 2.0583589057768545, "penalty_adv_drugs": 1.3233294640422763e-10, "penalty_adv_covariates": 8.939806135509523e-10}, "evaluation_stats": {"training": [0.9229979835066345, 0.6295165921492157, 0.7588475585948101, 0.510724305130277], "test": [0.9149921860102568, 0.7264933071137206, 0.7106429384142006, 0.45349457254676845], "ood": [-1, -1, -1, -1], "perturbation disentanglement": 0.01085310522466898, "optimal for perturbations": 0.014285714285714285, "celltype disentanglement": 0.5820292830467224, "optimal for celltype": 0.5, "donor disentanglement": 0.5190560817718506, "optimal for donor": 0.5, "stim disentanglement": 0.5421504378318787, "optimal for stim": 0.5}, "ellapsed_minutes": 47.94882394472758}
{"model_saved": "model_seed=0_epoch=600.pt\n"}
{"epoch": 620, "training_stats": {"loss_reconstruction": -1.4574584932096544, "loss_adv_drugs": 0.07276378968550314, "loss_adv_covariates": 2.0591310954863027, "penalty_adv_drugs": 6.72693458116595e-11, "penalty_adv_covariates": 6.472385566570805e-10}, "evaluation_stats": {"training": [0.9240658172342718, 0.6383641665719741, 0.7536898603448887, 0.49222933176862854], "test": [0.9259066432048119, 0.7789269087531153, 0.7131447328905703, 0.441006063609456], "ood": [-1, -1, -1, -1], "perturbation disentanglement": 0.012746088206768036, "optimal for perturbations": 0.014285714285714285, "celltype disentanglement": 0.6086572408676147, "optimal for celltype": 0.5, "donor disentanglement": 0.506562352180481, "optimal for donor": 0.5, "stim disentanglement": 0.5668854117393494, "optimal for stim": 0.5}, "ellapsed_minutes": 49.682827579975125}
{"model_saved": "model_seed=0_epoch=620.pt\n"}
{"epoch": 640, "training_stats": {"loss_reconstruction": -1.458928038997035, "loss_adv_drugs": 0.07274082321072778, "loss_adv_covariates": 2.058930168228765, "penalty_adv_drugs": 1.247771180572725e-07, "penalty_adv_covariates": 4.02143298947682e-10}, "evaluation_stats": {"training": [0.9247204770180755, 0.6309010384404982, 0.7551257732003149, 0.49724381533482404], "test": [0.914263217636886, 0.7119636464784938, 0.6979292013041535, 0.4136731519285623], "ood": [-1, -1, -1, -1], "perturbation disentanglement": 0.008581524714827538, "optimal for perturbations": 0.014285714285714285, "celltype disentanglement": 0.5704190135002136, "optimal for celltype": 0.5, "donor disentanglement": 0.4973498582839966, "optimal for donor": 0.5, "stim disentanglement": 0.5015144348144531, "optimal for stim": 0.5}, "ellapsed_minutes": 51.41733890374501}
{"model_saved": "model_seed=0_epoch=640.pt\n"}
{"epoch": 660, "training_stats": {"loss_reconstruction": -1.4623573412818294, "loss_adv_drugs": 0.07278656599021727, "loss_adv_covariates": 2.0576403160249033, "penalty_adv_drugs": 2.538569854683504e-10, "penalty_adv_covariates": 4.3572385618938897e-10}, "evaluation_stats": {"training": [0.9231839390345509, 0.6450685637415164, 0.7608424506535592, 0.5070856546009397], "test": [0.9186984438375951, 0.763879299663999, 0.7072735287271907, 0.4474212743452375], "ood": [-1, -1, -1, -1], "perturbation disentanglement": 0.014765270985662937, "optimal for perturbations": 0.014285714285714285, "celltype disentanglement": 0.5543917417526245, "optimal for celltype": 0.5, "donor disentanglement": 0.4857395589351654, "optimal for donor": 0.5, "stim disentanglement": 0.5017668008804321, "optimal for stim": 0.5}, "ellapsed_minutes": 52.76649938821792}
{"model_saved": "model_seed=0_epoch=660.pt\n"}
{"epoch": 680, "training_stats": {"loss_reconstruction": -1.4644916595951203, "loss_adv_drugs": 0.07277393605439894, "loss_adv_covariates": 2.0585685468489126, "penalty_adv_drugs": 2.5733785223435114e-11, "penalty_adv_covariates": 5.371337563799029e-10}, "evaluation_stats": {"training": [0.9240041367866101, 0.6434624996075177, 0.7609667945136728, 0.5189526705804101], "test": [0.9204795651148, 0.7611046744642556, 0.7091553353177433, 0.4437807681273404], "ood": [-1, -1, -1, -1], "perturbation disentanglement": 0.012746088206768036, "optimal for perturbations": 0.014285714285714285, "celltype disentanglement": 0.4830893576145172, "optimal for celltype": 0.5, "donor disentanglement": 0.4747602343559265, "optimal for donor": 0.5, "stim disentanglement": 0.5306663513183594, "optimal for stim": 0.5}, "ellapsed_minutes": 54.40727751255035}
{"model_saved": "model_seed=0_epoch=680.pt\n"}
{"epoch": 700, "training_stats": {"loss_reconstruction": -1.4655288034869778, "loss_adv_drugs": 0.0727755717572666, "loss_adv_covariates": 2.0568797242256904, "penalty_adv_drugs": 1.934484567265376e-07, "penalty_adv_covariates": 1.3458825004296305e-09}, "evaluation_stats": {"training": [0.9275252281971119, 0.6497919179375262, 0.7634123439696815, 0.5303409711575328], "test": [0.9266229227543784, 0.7912603423343377, 0.7202698492962615, 0.45959521192918], "ood": [-1, -1, -1, -1], "perturbation disentanglement": 0.010474508628249168, "optimal for perturbations": 0.014285714285714285, "celltype disentanglement": 0.49583545327186584, "optimal for celltype": 0.5, "donor disentanglement": 0.4883897304534912, "optimal for donor": 0.5, "stim disentanglement": 0.5176678895950317, "optimal for stim": 0.5}, "ellapsed_minutes": 56.171752719084424}
{"model_saved": "model_seed=0_epoch=700.pt\n"}
{"epoch": 720, "training_stats": {"loss_reconstruction": -1.462281250184582, "loss_adv_drugs": 0.07277140664237161, "loss_adv_covariates": 2.0574111227066285, "penalty_adv_drugs": 8.539000030134557e-10, "penalty_adv_covariates": 3.249909515336672e-09}, "evaluation_stats": {"training": [0.9303041788495733, 0.6545016176093155, 0.7688827957898094, 0.5213891197693152], "test": [0.9307398492128733, 0.8101451699275098, 0.73351115233311, 0.46414832955655366], "ood": [-1, -1, -1, -1], "perturbation disentanglement": 0.011862696148455143, "optimal for perturbations": 0.014285714285714285, "celltype disentanglement": 0.44611307978630066, "optimal for celltype": 0.5, "donor disentanglement": 0.4916709065437317, "optimal for donor": 0.5, "stim disentanglement": 0.5007572174072266, "optimal for stim": 0.5}, "ellapsed_minutes": 57.90671722888946}
{"model_saved": "model_seed=0_epoch=720.pt\n"}
{"epoch": 740, "training_stats": {"loss_reconstruction": -1.466419219009338, "loss_adv_drugs": 0.07279360462580958, "loss_adv_covariates": 2.0564875102812246, "penalty_adv_drugs": 6.952355645709152e-10, "penalty_adv_covariates": 3.068218492894364e-09}, "evaluation_stats": {"training": [0.9293035821977548, 0.655223366106899, 0.7661129470198277, 0.5252616224276456], "test": [0.9279130600644425, 0.7951306094304101, 0.7239975937111899, 0.46923975053587513], "ood": [-1, -1, -1, -1], "perturbation disentanglement": 0.0095911156386137, "optimal for perturbations": 0.014285714285714285, "celltype disentanglement": 0.5479555726051331, "optimal for celltype": 0.5, "donor disentanglement": 0.48195359110832214, "optimal for donor": 0.5, "stim disentanglement": 0.5128722786903381, "optimal for stim": 0.5}, "ellapsed_minutes": 59.52643451690674}
{"model_saved": "model_seed=0_epoch=740.pt\n"}
{"early_stop": 740}
